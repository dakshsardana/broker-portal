<h1 class="form-title">Cyber Insurance Quote</h1>

<form [formGroup]="form" class="quote-form">
    <!-- Company Details -->
    <div *ngIf="currentStep === 0" formGroupName="companyDetails">
        <h3>Company Details</h3>
        <label>Company Name:</label>
        <input type="text" formControlName="companyName">
        <p class="error" *ngIf="form.get('companyDetails.companyName')?.invalid && form.get('companyDetails.companyName')?.touched">
            Company name is required.
        </p>

        <label>Company Address:</label>
        <input type="text" formControlName="companyAddress">
        <p class="error" *ngIf="form.get('companyDetails.companyAddress')?.invalid && form.get('companyDetails.companyAddress')?.touched">
            Address is required.
        </p>

        <label>Business Type:</label>
        <input type="text" formControlName="businessType">
        <p class="error" *ngIf="form.get('companyDetails.businessType')?.invalid && form.get('companyDetails.businessType')?.touched">
            Business type is required.
        </p>

        <label>No. of Employees:</label>
        <input type="number" formControlName="numEmployees">
        <p class="error" *ngIf="form.get('companyDetails.numEmployees')?.invalid && form.get('companyDetails.numEmployees')?.touched">
            Enter a valid number.
        </p>
    </div>

    <!-- Cybersecurity Details -->
    <div *ngIf="currentStep === 1" formGroupName="cyberSecurity">
        <h3>Cybersecurity Details</h3>
        <label>Do you use a firewall?</label>
        <select formControlName="firewall">
            <option value="yes">Yes</option>
            <option value="no">No</option>
        </select>

        <label>Encryption Used:</label>
        <input type="text" formControlName="encryption">
        <p class="error" *ngIf="form.get('cyberSecurity.encryption')?.invalid && form.get('cyberSecurity.encryption')?.touched">
            Encryption method is required.
        </p>

        <label>Data Backup Policy:</label>
        <input type="text" formControlName="dataBackup">
        <p class="error" *ngIf="form.get('cyberSecurity.dataBackup')?.invalid && form.get('cyberSecurity.dataBackup')?.touched">
            Backup policy is required.
        </p>
    </div>

    <!-- Claims History -->
    <div *ngIf="currentStep === 2" formGroupName="claimsHistory">
        <h3>Claims History</h3>
        <label>Past Cyber Attacks:</label>
        <input type="text" formControlName="pastAttacks">

        <label>Financial Loss (in USD):</label>
        <input type="number" formControlName="financialLoss">
        <p class="error" *ngIf="form.get('claimsHistory.financialLoss')?.invalid && form.get('claimsHistory.financialLoss')?.touched">
            Enter a valid amount.
        </p>
    </div>

    <!-- Insurance Coverage -->
    <div *ngIf="currentStep === 3" formGroupName="coverage">
        <h3>Insurance Coverage</h3>
        <label>Desired Coverage Amount:</label>
        <input type="number" formControlName="coverageAmount">
        <p class="error" *ngIf="form.get('coverage.coverageAmount')?.invalid && form.get('coverage.coverageAmount')?.touched">
            Coverage amount is required.
        </p>

        <label>Deductible Amount:</label>
        <input type="number" formControlName="deductible">
        <p class="error" *ngIf="form.get('coverage.deductible')?.invalid && form.get('coverage.deductible')?.touched">
            Deductible amount is required.
        </p>
    </div>

    <!-- Navigation Buttons -->
    <div class="button-container">
        <button type="button" (click)="goPrevious()" [disabled]="currentStep === 0">Previous</button>
        <button type="button" *ngIf="currentStep < steps.length - 1" (click)="goNext()" [disabled]="!isStepValid()">Next</button>
        <button type="button" *ngIf="currentStep === steps.length - 1" (click)="onSubmit()" [disabled]="!form.valid">Submit</button>
    </div>

    <!-- Quote Details -->
    <div *ngIf="premium !== null">
        <h2>Calculated Premium</h2>
        <p>Your estimated premium is: <strong>{{ premium }}</strong></p>
    </div>
</form>
